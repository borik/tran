{"version":3,"sources":["js/es6/content_script/tooltip.js"],"names":[],"mappings":"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","file":"js/es6/content_script/tooltip.js","sourcesContent":["var TOOLTIP_CLASS = '__mtt_translate_dialog__'\nvar ctrlDown = false\nvar ctrlKey = 17;\nvar cmdKey = 91;\nvar cKey = 67;\n\nclass Tooltip {\n  constructor (coordinates) {\n    this.setListeners();\n    this.clickTarget = null;\n  }\n\n  createEl () {\n    this.el = document.createElement('div');\n    self = this;\n    chrome.storage.sync.get({ memorize: false}, function (items) {\n      var tclass = TOOLTIP_CLASS;\n      if (items.memorize) {\n        tclass += ' memorize';\n      }\n      self.el.className = tclass;\n      return true;\n    });\n    this.el.addEventListener('mousedown', e => e.stopPropagation());\n    this.el.addEventListener('keydown', this.onKeyDown);\n\n  }\n  onKeyDown (e) {\n    if (ctrlDown && (e.keyCode == vKey || e.keyCode == cKey)) {\n      e.stopPropagation()\n      return true;\n    }\n  }\n  setListeners () {\n    window.addEventListener('mousedown', e => this.destroy(e))\n    document.addEventListener('mousedown', e => this.destroy(e))\n    window.addEventListener('blur', e => this.destroy(e))\n    document.addEventListener('keydown', e => this.keydown(e))\n    document.addEventListener('keyup', e => this.keyup(e))\n  }\n  render (data, transform = null) {\n    if (!this.el) {\n      this.createEl();\n    }\n    this.el.innerHTML = data;\n    if (transform) { transform(this.el) }\n    this.el.style.left = this.coordinates.mouseX + 'px';\n    this.el.style.top = this.coordinates.mouseY + 'px';\n    document.body.appendChild(this.el);\n  }\n\n  keydown (e) {\n    if (e.keyCode == ctrlKey || e.keyCode == cmdKey) {\n      ctrlDown = true;\n    }\n    if (ctrlDown && (e.keyCode == ctrlKey || e.keyCode == cKey || e.keyCode == cmdKey)) {\n      return true;\n    } else {\n      this.destroy(e);\n    }\n  }\n\n  keyup (e) {\n    if (e.keyCode == ctrlKey) {\n      ctrlDown = false;\n    }\n  }\n\n  destroy (e) {\n    if (this.el && this.el.parentNode == document.body) {\n      document.body.removeChild(this.el);\n      this.el = null;\n      this.clickTarget = null  // reset click target\n    }\n  }\n\n  setCoordinates (coordinates) {\n    this.coordinates = coordinates;\n  }\n}\n\nmodule.exports = Tooltip"]}