{"version":3,"sources":["js/es6/content_script/tooltip.js"],"names":[],"mappings":"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","file":"js/es6/content_script/tooltip.js","sourcesContent":["var TOOLTIP_CLASS = '__mtt_translate_dialog__'\nvar ctrlDown = false\nvar ctrlKey = 17;\nvar cmdKey = 91;\nvar cKey = 67;\n\nclass Tooltip {\n  constructor (coordinates) {\n    this.setListeners();\n    this.clickTarget = null;\n  }\n\n  createEl () {\n    this.el = document.createElement('div');\n    var self = this;\n    chrome.storage.sync.get({ memorize: false}, function (items) {\n      var tclass = TOOLTIP_CLASS;\n      if (items.memorize) {\n        tclass += ' memorize';\n      }\n      self.el.className = tclass;\n      return true;\n    });\n    this.el.addEventListener('mousedown', e => e.stopPropagation());\n    this.el.addEventListener('keydown', this.onKeyDown);\n\n  }\n  onKeyDown (e) {\n    if (ctrlDown && (e.keyCode == vKey || e.keyCode == cKey)) {\n      e.stopPropagation()\n      return true;\n    }\n  }\n  setListeners () {\n    window.addEventListener('mousedown', e => this.destroy(e))\n    document.addEventListener('mousedown', e => this.destroy(e))\n    window.addEventListener('blur', e => this.destroy(e))\n    document.addEventListener('keydown', e => this.keydown(e))\n    document.addEventListener('keyup', e => this.keyup(e))\n  }\n\n  render (data, transform = null) {\n    if (!this.el) {\n      this.createEl();\n    }\n    this.el.innerHTML = data;\n    if (transform) { transform(this.el) }\n    this.el.style.left = this.coordinates.mouseX + 'px';\n    this.el.style.top = this.coordinates.mouseY + 'px';\n    document.body.appendChild(this.el);\n  }\n\n  keydown (e) {\n    if (e.keyCode == ctrlKey || e.keyCode == cmdKey) {\n      ctrlDown = true;\n    }\n    if (ctrlDown && (e.keyCode == ctrlKey || e.keyCode == cKey || e.keyCode == cmdKey)) {\n      return true;\n    } else {\n      this.destroy(e);\n    }\n  }\n\n  keyup (e) {\n    if (e.keyCode == ctrlKey) {\n      ctrlDown = false;\n    }\n  }\n\n  destroy (e) {\n    if (this.el && this.el.parentNode == document.body) {\n      document.body.removeChild(this.el);\n      this.el = null;\n      this.clickTarget = null  // reset click target\n    }\n  }\n\n  setCoordinates (coordinates) {\n    this.coordinates = coordinates;\n  }\n}\n\nmodule.exports = Tooltip"]}